!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.multiItemActPlayer=e():t.multiItemActPlayer=e()}(window,(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){"use strict";n.r(e),n.d(e,"h",(function(){return a})),n.d(e,"createElement",(function(){return a})),n.d(e,"cloneElement",(function(){return l})),n.d(e,"createRef",(function(){return V})),n.d(e,"Component",(function(){return H})),n.d(e,"render",(function(){return F})),n.d(e,"rerender",(function(){return f})),n.d(e,"options",(function(){return o}));var i=function(){},o={},r=[],s=[];function a(t,e){var n,a,c,u,p=s;for(u=arguments.length;u-- >2;)r.push(arguments[u]);for(e&&null!=e.children&&(r.length||r.push(e.children),delete e.children);r.length;)if((a=r.pop())&&void 0!==a.pop)for(u=a.length;u--;)r.push(a[u]);else"boolean"==typeof a&&(a=null),(c="function"!=typeof t)&&(null==a?a="":"number"==typeof a?a=String(a):"string"!=typeof a&&(c=!1)),c&&n?p[p.length-1]+=a:p===s?p=[a]:p.push(a),n=c;var l=new i;return l.nodeName=t,l.children=p,l.attributes=null==e?void 0:e,l.key=null==e?void 0:e.key,void 0!==o.vnode&&o.vnode(l),l}function c(t,e){for(var n in e)t[n]=e[n];return t}function u(t,e){t&&("function"==typeof t?t(e):t.current=e)}var p="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function l(t,e){return a(t.nodeName,c(c({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}var h=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function m(t){!t._dirty&&(t._dirty=!0)&&1==d.push(t)&&(o.debounceRendering||p)(f)}function f(){for(var t;t=d.pop();)t._dirty&&M(t)}function y(t,e,n){return"string"==typeof e||"number"==typeof e?void 0!==t.splitText:"string"==typeof e.nodeName?!t._componentConstructor&&I(t,e.nodeName):n||t._componentConstructor===e.nodeName}function I(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function v(t){var e=c({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var i in n)void 0===e[i]&&(e[i]=n[i]);return e}function g(t){var e=t.parentNode;e&&e.removeChild(t)}function S(t,e,n,i,o){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)u(n,null),u(i,t);else if("class"!==e||o)if("style"===e){if(i&&"string"!=typeof i&&"string"!=typeof n||(t.style.cssText=i||""),i&&"object"==typeof i){if("string"!=typeof n)for(var r in n)r in i||(t.style[r]="");for(var r in i)t.style[r]="number"==typeof i[r]&&!1===h.test(r)?i[r]+"px":i[r]}}else if("dangerouslySetInnerHTML"===e)i&&(t.innerHTML=i.__html||"");else if("o"==e[0]&&"n"==e[1]){var s=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),i?n||t.addEventListener(e,E,s):t.removeEventListener(e,E,s),(t._listeners||(t._listeners={}))[e]=i}else if("list"!==e&&"type"!==e&&!o&&e in t){try{t[e]=null==i?"":i}catch(t){}null!=i&&!1!==i||"spellcheck"==e||t.removeAttribute(e)}else{var a=o&&e!==(e=e.replace(/^xlink:?/,""));null==i||!1===i?a?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof i&&(a?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),i):t.setAttribute(e,i))}else t.className=i||""}function E(t){return this._listeners[t.type](o.event&&o.event(t)||t)}var C=[],b=0,_=!1,B=!1;function A(){for(var t;t=C.shift();)o.afterMount&&o.afterMount(t),t.componentDidMount&&t.componentDidMount()}function N(t,e,n,i,o,r){b++||(_=null!=o&&void 0!==o.ownerSVGElement,B=null!=t&&!("__preactattr_"in t));var s=T(t,e,n,i,r);return o&&s.parentNode!==o&&o.appendChild(s),--b||(B=!1,r||A()),s}function T(t,e,n,i,o){var r=t,s=_;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||o)?t.nodeValue!=e&&(t.nodeValue=e):(r=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(r,t),x(t,!0))),r.__preactattr_=!0,r;var a,c,u=e.nodeName;if("function"==typeof u)return function(t,e,n,i){var o=t&&t._component,r=o,s=t,a=o&&t._componentConstructor===e.nodeName,c=a,u=v(e);for(;o&&!c&&(o=o._parentComponent);)c=o.constructor===e.nodeName;o&&c&&(!i||o._component)?(D(o,u,3,n,i),t=o.base):(r&&!a&&(L(r),t=s=null),o=P(e.nodeName,u,n),t&&!o.nextBase&&(o.nextBase=t,s=null),D(o,u,1,n,i),t=o.base,s&&t!==s&&(s._component=null,x(s,!1)));return t}(t,e,n,i);if(_="svg"===u||"foreignObject"!==u&&_,u=String(u),(!t||!I(t,u))&&(a=u,(c=_?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a)).normalizedNodeName=a,r=c,t)){for(;t.firstChild;)r.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(r,t),x(t,!0)}var p=r.firstChild,l=r.__preactattr_,h=e.children;if(null==l){l=r.__preactattr_={};for(var d=r.attributes,m=d.length;m--;)l[d[m].name]=d[m].value}return!B&&h&&1===h.length&&"string"==typeof h[0]&&null!=p&&void 0!==p.splitText&&null==p.nextSibling?p.nodeValue!=h[0]&&(p.nodeValue=h[0]):(h&&h.length||null!=p)&&function(t,e,n,i,o){var r,s,a,c,u,p=t.childNodes,l=[],h={},d=0,m=0,f=p.length,I=0,v=e?e.length:0;if(0!==f)for(var S=0;S<f;S++){var E=p[S],C=E.__preactattr_;null!=(b=v&&C?E._component?E._component.__key:C.key:null)?(d++,h[b]=E):(C||(void 0!==E.splitText?!o||E.nodeValue.trim():o))&&(l[I++]=E)}if(0!==v)for(S=0;S<v;S++){var b;if(c=e[S],u=null,null!=(b=c.key))d&&void 0!==h[b]&&(u=h[b],h[b]=void 0,d--);else if(m<I)for(r=m;r<I;r++)if(void 0!==l[r]&&y(s=l[r],c,o)){u=s,l[r]=void 0,r===I-1&&I--,r===m&&m++;break}u=T(u,c,n,i),a=p[S],u&&u!==t&&u!==a&&(null==a?t.appendChild(u):u===a.nextSibling?g(a):t.insertBefore(u,a))}if(d)for(var S in h)void 0!==h[S]&&x(h[S],!1);for(;m<=I;)void 0!==(u=l[I--])&&x(u,!1)}(r,h,n,i,B||null!=l.dangerouslySetInnerHTML),function(t,e,n){var i;for(i in n)e&&null!=e[i]||null==n[i]||S(t,i,n[i],n[i]=void 0,_);for(i in e)"children"===i||"innerHTML"===i||i in n&&e[i]===("value"===i||"checked"===i?t[i]:n[i])||S(t,i,n[i],n[i]=e[i],_)}(r,e.attributes,l),_=s,r}function x(t,e){var n=t._component;n?L(n):(null!=t.__preactattr_&&u(t.__preactattr_.ref,null),!1!==e&&null!=t.__preactattr_||g(t),R(t))}function R(t){for(t=t.lastChild;t;){var e=t.previousSibling;x(t,!0),t=e}}var O=[];function P(t,e,n){var i,o=O.length;for(t.prototype&&t.prototype.render?(i=new t(e,n),H.call(i,e,n)):((i=new H(e,n)).constructor=t,i.render=w);o--;)if(O[o].constructor===t)return i.nextBase=O[o].nextBase,O.splice(o,1),i;return i}function w(t,e,n){return this.constructor(t,n)}function D(t,e,n,i,r){t._disable||(t._disable=!0,t.__ref=e.ref,t.__key=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||r?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,i)),i&&i!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=i),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===o.syncComponentUpdates&&t.base?m(t):M(t,1,r)),u(t.__ref,t))}function M(t,e,n,i){if(!t._disable){var r,s,a,u=t.props,p=t.state,l=t.context,h=t.prevProps||u,d=t.prevState||p,m=t.prevContext||l,f=t.base,y=t.nextBase,I=f||y,g=t._component,S=!1,E=m;if(t.constructor.getDerivedStateFromProps&&(p=c(c({},p),t.constructor.getDerivedStateFromProps(u,p)),t.state=p),f&&(t.props=h,t.state=d,t.context=m,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(u,p,l)?S=!0:t.componentWillUpdate&&t.componentWillUpdate(u,p,l),t.props=u,t.state=p,t.context=l),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!S){r=t.render(u,p,l),t.getChildContext&&(l=c(c({},l),t.getChildContext())),f&&t.getSnapshotBeforeUpdate&&(E=t.getSnapshotBeforeUpdate(h,d));var _,B,T=r&&r.nodeName;if("function"==typeof T){var R=v(r);(s=g)&&s.constructor===T&&R.key==s.__key?D(s,R,1,l,!1):(_=s,t._component=s=P(T,R,l),s.nextBase=s.nextBase||y,s._parentComponent=t,D(s,R,0,l,!1),M(s,1,n,!0)),B=s.base}else a=I,(_=g)&&(a=t._component=null),(I||1===e)&&(a&&(a._component=null),B=N(a,r,l,n||!f,I&&I.parentNode,!0));if(I&&B!==I&&s!==g){var O=I.parentNode;O&&B!==O&&(O.replaceChild(B,I),_||(I._component=null,x(I,!1)))}if(_&&L(_),t.base=B,B&&!i){for(var w=t,H=t;H=H._parentComponent;)(w=H).base=B;B._component=w,B._componentConstructor=w.constructor}}for(!f||n?C.push(t):S||(t.componentDidUpdate&&t.componentDidUpdate(h,d,E),o.afterUpdate&&o.afterUpdate(t));t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);b||i||A()}}function L(t){o.beforeUnmount&&o.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?L(n):e&&(null!=e.__preactattr_&&u(e.__preactattr_.ref,null),t.nextBase=e,g(e),O.push(t),R(e)),u(t.__ref,null)}function H(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{},this._renderCallbacks=[]}function F(t,e,n){return N(n,t,{},!1,e,!1)}function V(){return{}}c(H.prototype,{setState:function(t,e){this.prevState||(this.prevState=this.state),this.state=c(c({},this.state),"function"==typeof t?t(this.state,this.props):t),e&&this._renderCallbacks.push(e),m(this)},forceUpdate:function(t){t&&this._renderCallbacks.push(t),M(this,2)},render:function(){}});var k={h:a,createElement:a,cloneElement:l,createRef:V,Component:H,render:F,rerender:f,options:o};e.default=k},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Components={ACTIVITY_PLAYER:"activity-player",ITEM_PLAYER:"item-player",BUTTON_BAR:"button-bar",LOADER:"loader"},e.NAVIGATION_EVENTS={PREVIOUS:"previous",NEXT:"next",SPECIFIC:"specific"},e.NAVIGATION_BUTTONS_STATE={HIDDEN:"hidden",DISABLED:"disabled"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.NOTSTARTED="NotStarted",t.INPROGRESS="InProgress",t.COMPLETED="Completed"}(e.Status||(e.Status={})),function(t){t.ATTEMPT="attempt",t.REVIEW="review"}(e.LaunchModes||(e.LaunchModes={})),function(t){t.CORRECT="correct",t.INCORRECT="incorrect",t.PARTIALLY_CORRECT="partiallyCorrect"}(e.ScoreStatus||(e.ScoreStatus={})),function(t){t.COMPLETE="complete",t.INCOMPLETE="incomplete",t.NOT_ATTEMPTED="notAttempted"}(e.CompletionStatus||(e.CompletionStatus={})),function(t){t.PLAYER="player"}(e.RendererTypes||(e.RendererTypes={}))},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){this.launchId=t.launchId,this.type=t.type};e.EventArgs=r;var s=function(t){function e(e){var n=t.call(this,e)||this;return n.response=e.response,n}return o(e,t),e}(r);e.SubmitEventArgs=s;var a=function(t){function e(e){var n=t.call(this,e)||this;return n.itemId="",n.playerInstance=e.playerInstance,n}return o(e,t),e}(r);e.ReadyEventArgs=a;var c=function(t){function e(e){var n=t.call(this,e)||this;return n.error=e.exception,n}return o(e,t),e}(r);e.ErrorEventArgs=c;var u=function(t){function e(e){var n=t.call(this,e)||this;return n.itemId=e.itemId,n.itemPayload=e.itemPayload,n}return o(e,t),e}(r);e.InteractedEventArgs=u;var p=function(t){function e(e){var n=t.call(this,e)||this;return n.previousItem=e.previousItem,n.currentItem=e.currentItem,n}return o(e,t),e}(r);e.NavigationEventArgs=p;var l=function(t){function e(e){var n=t.call(this,e)||this;return n.size=e.size,n}return o(e,t),e}(r);e.SizeEventArgs=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EVENTS={ERROR:"error",INTERACTED:"interacted",LAUNCHED:"launched",SIZE:"size",READY:"ready",CHECK_ANSWER:"checkAnswer",RETRY:"retry",RESET:"reset",SUBMIT:"submit",HINT_CONSUMED:"hintConsumed",DESTROY:"destroy",ITEM_NAVIGATION:"itemNavigation",CHANGE:"change"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonBarIcons={reset:"reset",checkMyWork:"checkMyWork",tryAgain:"tryAgain",showHint:"showHint",closeHint:"closeHint",previous:"previous",next:"next"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5);e.checkMyWorkBtn=[{id:i.ButtonBarIcons.checkMyWork,tooltip:"Check my work",className:"defaultBtn-check-mywork-icon",text:"Check my work",icon:{iconCls_left:"la la-tick"}},{id:i.ButtonBarIcons.tryAgain,tooltip:"Try Again",className:"defaultBtn-tryAgain",text:"Try again",icon:{iconCls_left:"la la-try-again"}}],e.hintsBtn=[{id:i.ButtonBarIcons.showHint,tooltip:"Hint",className:"defaultBtn-hint-icon",text:"Hint",icon:{iconCls_left:"la la-hintDefault"}},{id:i.ButtonBarIcons.closeHint,tooltip:"Close hint",className:"defaultBtn-hintEnabled-icon",text:"Hint",icon:{iconCls_left:"la la-hintDefault",iconCls_right:"la la-close"}}],e.resetBtn=[{id:i.ButtonBarIcons.reset,tooltip:"Reset",className:"defaultBtn-reset-icon",text:"Reset",icon:{iconCls_left:"la la-reset"}}],e.navigationBtn=[{id:i.ButtonBarIcons.previous,tooltip:"Previous",className:"defaultBtn-previous-icon",text:"Previous",icon:{iconCls_left:"la la-left"}},{id:i.ButtonBarIcons.next,tooltip:"Next",className:"defaultBtn-next-icon",text:"Next",icon:{iconCls_left:"la la-right"}}]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cloneObject=function(t){return JSON.parse(JSON.stringify(t))}},function(t,e,n){t.exports=n(9)},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=n(10),s=n(0),a=n(14),c=n(1),u=n(2),p=function(t){function e(){return t.call(this)||this}return o(e,t),e.prototype.render=function(t,e){try{if(!e){if(!this.container)throw new Error("Container not present to render Activity Player");e=this.container}s.render(s.h(a.MultiItemActivityComponent,{context:this,registerChildComp:this.registerChildComp.bind(this),selectedItemIndex:this.firstItemIndexToLaunch}),e)}catch(t){this.onErrorHandler(this.launchId,t)}},e.prototype.renderItem=function(t,e){return this.items[t].render(e)},e.prototype.registerChildComp=function(t,e){switch(t){case c.Components.ACTIVITY_PLAYER:this.activityPlayerComp=e}},e.prototype.focalise=function(){try{if(!this.getCurrentItem())throw new Error("No Item Present to focalise");this.getCurrentItem().focalise()}catch(t){this.onErrorHandler(this.launchId,t)}},e.prototype.getOptimumDimensions=function(){try{if(this.activityPlayerComp)return this.activityPlayerComp.getOptimumDimensions();throw new Error("Activity Player is not rendered yet.")}catch(t){this.onErrorHandler(this.launchId,t)}},e.prototype.goToNextItem=function(){try{if(!this.activityPlayerComp)throw new Error("Activity Player is not rendered yet.");this.activityPlayerComp.onItemNavigation(c.NAVIGATION_EVENTS.NEXT)}catch(t){this.onErrorHandler(this.launchId,t)}},e.prototype.goToPreviousItem=function(){try{if(!this.activityPlayerComp)throw new Error("Activity Player is not rendered yet.");this.activityPlayerComp.onItemNavigation(c.NAVIGATION_EVENTS.PREVIOUS)}catch(t){this.onErrorHandler(this.launchId,t)}},e.prototype.goToItem=function(t){try{if(!this.activityPlayerComp)throw new Error("Activity Player is not rendered yet.");this.activityPlayerComp.onItemNavigation(c.NAVIGATION_EVENTS.SPECIFIC,t)}catch(t){this.onErrorHandler(this.launchId,t)}},e.prototype.destroy=function(){this.destroyItems(),this.activityPlayerComp.destroy(),this.activityPlayerComp=null,t.prototype.destroy.call(this)},e.prototype.reset=function(){this.activityPlayerComp.reset(),t.prototype.reset.call(this)},e.prototype.onSizeHandler=function(e){var n=this.activityPlayerComp.getOptimumDimensions(e.size);this.activityPlayerComp.resizeActivityPlayer(n),t.prototype.onSizeHandler.call(this,{size:n})},e.prototype.getItemEvents=function(){var e=t.prototype.getItemEvents.call(this);return e.launched=this.onLaunchedHandler.bind(this),e},e.prototype.onLaunchedHandler=function(t){this.activityPlayerComp.onLaunchedHandler()},e.prototype.resetDimensions=function(){this.getCurrentItem().resetDimensions()},e.prototype.getItemCount=function(){return this.activityJson.itemBody.questions.length},e.prototype.getFirstItemToLaunch=function(){return this.options&&this.options.playerConfig&&this.options.playerConfig.selectedItemIndex?this.options.playerConfig.selectedItemIndex:t.prototype.getFirstItemToLaunch.call(this)},e.prototype.getItemDefaultScore=function(t){var e=this.activityJson.itemBody.questions[t];return{score:{min:0,max:0|e.meta.score,raw:0|e.meta.defaultScore,scaled:e.meta.defaultScore/e.meta.score|0},status:u.ScoreStatus.INCORRECT,interacted:!1,completion:u.CompletionStatus.NOT_ATTEMPTED}},e.prototype.getItemFragmentIdFromItemIndex=function(t){return this.activityJson.itemBody.questions[t].id},e}(r.BaseActivityPlayer);e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),o=n(4),r=n(3),s=n(13),a=n(2),c=function(){function t(){this.items=[],this.launchId="",this.container=null,this.eventMgr=new LeonardoApp.EventEmitter,this.manageActivityState=!0,this.firstItemIndexToLaunch=0}return t.prototype.init=function(t,e,n,i){var o=this;if(this.launchId=t,this.activityJson=e,this.manageActivityState&&(this.activityStateService=new s.ActivityStateService(e)),i?(this.container=n,this.options=i):n instanceof HTMLElement?this.container=n:this.options=n,this.options&&this.options.state&&this.setState(this.options.state),this.firstItemIndexToLaunch=this.getFirstItemToLaunch(),this.options&&this.options.events)for(var r in this.options.events)this.subscribe(r,this.options.events[r]);var a=this.getItemEvents();return new Promise((function(n,i){try{var r=o,s=o.options&&o.options.playerConfig&&o.options.playerConfig.uiStyles?o.options.playerConfig.uiStyles:null;if(e)r.initItem(r.firstItemIndexToLaunch,e,a,s).then((function(){r.currentItem=r.items[r.firstItemIndexToLaunch],n(r)})).catch((function(){var e=new Error("Invalid Item Json");r.onErrorHandler(t,e),i(e)})),r.initUnselectedItems(r.firstItemIndexToLaunch,e,a,s);else{var c=new Error("Invalid Activity Json");o.onErrorHandler(t,c),i(c)}}catch(e){o.onErrorHandler(t,e)}}))},t.prototype.destroy=function(){var t={launchId:this.launchId,type:o.EVENTS.DESTROY};this.eventMgr.emit(o.EVENTS.DESTROY,new r.EventArgs(t))},t.prototype.subscribe=function(t,e){this.eventMgr.on(t,e)},t.prototype.unsubscribe=function(t,e){this.eventMgr.off(t,e)},t.prototype.getItems=function(){return this.items},t.prototype.getCurrentItem=function(){return this.currentItem},t.prototype.getCurrentItemIndex=function(){return this.currentItem.index},t.prototype.getItem=function(t){return this.items[t]},t.prototype.reset=function(){if(this.currentItem.reset(),this.manageActivityState){var t=this.getFragmentIdFromIndex(this.getCurrentItemIndex());this.activityStateService.setItemStatus(t,a.Status.INPROGRESS),this.updateCurrentItemState()}var e={launchId:this.launchId,type:o.EVENTS.RESET};this.eventMgr.emit(o.EVENTS.RESET,new r.EventArgs(e))},t.prototype.save=function(t){},t.prototype.submit=function(t,e){if(this.manageActivityState)for(var n=this.getItemCount(),i=0;i<n;i++){var o=this.getFragmentIdFromIndex(i);if(this.activityStateService.getItemStatus(o)!=a.Status.COMPLETED){var r=void 0;if(this.items[i]){var s=this.items[i];r=s.getScore(),this.activityStateService.setItemState(o,s.getState())}r||(r=this.getItemDefaultScore(i)),this.activityStateService.setItemScore(o,r),this.activityStateService.setItemStatus(o,a.Status.COMPLETED)}}this.submitActivity(t)},t.prototype.checkAnswer=function(t,e){var n=this.getCurrentItem().submit();if(n&&this.manageActivityState){var i=this.getFragmentIdFromIndex(this.getCurrentItemIndex());this.updateCurrentItemState(),this.activityStateService.setItemStatus(i,a.Status.COMPLETED)}var s={launchId:this.launchId,type:o.EVENTS.CHECK_ANSWER,status:n?"success":"error"};n&&(s.response={score:this.currentItem.getScore().score}),t?t(s):this.eventMgr.emit(o.EVENTS.CHECK_ANSWER,new r.SubmitEventArgs(s))},t.prototype.retry=function(t){if(this.manageActivityState){var e=this.getFragmentIdFromIndex(this.getCurrentItemIndex());this.activityStateService.setItemStatus(e,a.Status.INPROGRESS)}if(this.getCurrentItem().retry(),t)t();else{var n={launchId:this.launchId,type:o.EVENTS.RETRY};this.eventMgr.emit(o.EVENTS.RETRY,new r.EventArgs(n))}},t.prototype.getResponse=function(){if(this.manageActivityState){for(var t={min:0,max:0,raw:0,scaled:0},e=this.getItemCount(),n=0;n<e;n++){var i=this.activityStateService.getItemScore(this.getFragmentIdFromIndex(n));if(!i){var o=this.getFragmentIdFromIndex(n);i=this.getItemDefaultScore(n),this.activityStateService.setItemScore(o,i)}t.min+=i.score.min/i.score.max,t.raw+=i.score.scaled}return t.max=e,t.scaled=t.raw/t.max,t}return{min:0,max:this.getItemCount(),raw:0,scaled:0}},t.prototype.getState=function(){if(this.manageActivityState)return JSON.parse(JSON.stringify(this.activityStateService.getActivityState()))},t.prototype.setState=function(t){if(this.manageActivityState){this.activityStateService.setActivityState(t);for(var e=this.getItemCount(),n=0;n<e;n++)if(this.items[n]){var i=this.activityStateService.getItemState(this.getFragmentIdFromIndex(n)),o=this.isReviewMode()?a.LaunchModes.REVIEW:a.LaunchModes.ATTEMPT;this.items[n].setState(i,o)}}},t.prototype.getCurrentItemStatus=function(){var t=a.Status.NOTSTARTED;if(this.manageActivityState){var e=this.getFragmentIdFromIndex(this.getCurrentItemIndex());t=this.activityStateService.getItemStatus(e)}return t},t.prototype.getCurrentItemScore=function(){var t,e=this.getCurrentItemIndex();return this.manageActivityState&&(t=this.activityStateService.getItemScore(this.getFragmentIdFromIndex(e))),t||this.getItemDefaultScore(e)},t.prototype.displayFeedback=function(t){this.getCurrentItem().displayFeedback(t)},t.prototype.destroyItems=function(){this.items.forEach((function(t){t.destroy()})),delete this.currentItem,this.items=[]},t.prototype.updateCurrentItemState=function(){if(this.manageActivityState){var t=this.getFragmentIdFromIndex(this.getCurrentItemIndex());this.activityStateService.setItemState(t,this.getCurrentItem().getState()),this.activityStateService.setItemScore(t,this.getCurrentItem().getScore())}},t.prototype.onErrorHandler=function(t,e){var n={launchId:t,type:o.EVENTS.ERROR,exception:e};this.eventMgr.emit(o.EVENTS.ERROR,new r.ErrorEventArgs(n))},t.prototype.onInteractedHandler=function(t){if(this.manageActivityState){var e=this.getFragmentIdFromIndex(this.getCurrentItemIndex());this.activityStateService.setItemState(e,t.state)}var n={launchId:this.launchId,type:o.EVENTS.CHANGE,state:this.getState()};this.eventMgr.emit(o.EVENTS.CHANGE,new r.InteractedEventArgs(n))},t.prototype.onSizeHandler=function(t){var e={launchId:this.launchId,type:o.EVENTS.INTERACTED,size:t.size};this.eventMgr.emit(o.EVENTS.SIZE,new r.SizeEventArgs(e))},t.prototype.onRedoHandler=function(t){if(this.manageActivityState){var e=this.getFragmentIdFromIndex(this.getCurrentItemIndex());this.activityStateService.setItemState(e,this.currentItem.getState())}},t.prototype.getItemEvents=function(){return{interacted:this.onInteractedHandler.bind(this),size:this.onSizeHandler.bind(this),error:this.onErrorHandler.bind(this),redo:this.onRedoHandler.bind(this)}},t.prototype.getItemState=function(t){var e=null;if(this.manageActivityState){var n=this.getFragmentIdFromIndex(t);e=this.activityStateService.getItemState(n)}return e},t.prototype.displayHints=function(){return this.getCurrentItem().showHints()},t.prototype.setCurrentItem=function(t){this.currentItem=t,this.manageActivityState&&this.activityStateService.setSelectedItemIndex(t.index)},t.prototype.getFirstItemToLaunch=function(){return this.manageActivityState?this.isReviewMode()?0:this.activityStateService.getSelectedItemIndex():0},t.prototype.initUnselectedItems=function(t,e,n,i){for(var o=this.getItemCount(),r=0;r<o;r++)r!=t&&this.initItem(r,e,n,i)},t.prototype.initItem=function(t,e,n,o){var r=new i.ItemApp,s=this.isReviewMode()?a.LaunchModes.REVIEW:a.LaunchModes.ATTEMPT;r.setState(this.getItemState(t),s);var c=this.getFragmentIdFromIndex(t),u=e.itemFragments[c];return this.items[t]=r,r.init(c,t,u.itemId,this.launchId,{events:n,uiStyle:o,eventMgr:this.eventMgr})},t.prototype.submitActivity=function(t){var e=this.getResponse();this.manageActivityState&&this.activityStateService.setActivityScore(e);var n={launchId:this.launchId,type:o.EVENTS.SUBMIT,response:{score:e}};t?t(n):this.eventMgr.emit(o.EVENTS.SUBMIT,new r.SubmitEventArgs(n))},t.prototype.isReviewMode=function(){return!(!this.manageActivityState||this.activityStateService.getActivityStatus()!=a.Status.COMPLETED)},t.prototype.getFragmentIdFromIndex=function(t){return this.items[t]?this.items[t].uid:this.getItemFragmentIdFromItemIndex(t)},t}();e.BaseActivityPlayer=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=n(3),r=n(4),s=n(12),a=n(2);!function(t){t[t.INITIAL=0]="INITIAL",t[t.LOADED=1]="LOADED",t[t.RENDERED=2]="RENDERED"}(i||(i={}));var c=function(){function t(){this.uid="",this.index=-1,this.ItemLifeCycleState=i.INITIAL,this.launchId="",this.state=null,this.launchMode=a.LaunchModes.ATTEMPT,this.isHintsDisplayed=!1}return t.prototype.init=function(t,e,n,o,r){this.uid=t,this.index=e,this.launchId=o,this.options=r,r&&r.eventMgr&&(this.eventMgr=r.eventMgr);var s=this;return new Promise((function(t,e){s.fetchItemJSON(n).then((function(t){if(s.itemJSON=t,s.isItemJsonValid())return s.loadItemPlayer(t);throw new Error("Invalid Item Json")})).then((function(e){s.itemPlayer=new e,s.ItemLifeCycleState=i.LOADED,t()})).catch((function(t){s.errorHandler(o,t),e()}))}))},t.prototype.render=function(t){var e={events:this.options.events,uiStyle:this.options.uiStyle,playerButtons:{visible:!1}};e.uiStyle=new Object(e.uiStyle),e.uiStyle.widgetStyles={"box-shadow":"none",border:"none"};var n=this;return new Promise((function(o,r){if(n.ItemLifeCycleState==i.LOADED)n.renderItemPlayer(t,e),o(n);else var s=setInterval((function(){n.ItemLifeCycleState==i.LOADED&&(clearInterval(s),n.renderItemPlayer(t,e),o(n))}),50)}))},t.prototype.save=function(){},t.prototype.submit=function(){var t=!1;return this.ItemLifeCycleState==i.RENDERED&&(t=this.itemPlayer.validateResponse({displayFeedback:!0}))&&this.itemPlayer.lock(),t},t.prototype.retry=function(){try{this.ItemLifeCycleState==i.RENDERED&&(this.itemPlayer.redo({retainUserResponse:!0}),this.itemPlayer.unlock(),this.isHintsDisplayed=!1)}catch(t){this.errorHandler(this.launchId,t)}},t.prototype.reset=function(){try{this.ItemLifeCycleState==i.RENDERED&&(this.itemPlayer.redo(),this.isHintsDisplayed=!1)}catch(t){this.errorHandler(this.launchId,t)}},t.prototype.resetDimensions=function(){this.ItemLifeCycleState==i.RENDERED&&this.itemPlayer.resetDimensions()},t.prototype.showHints=function(){if(this.ItemLifeCycleState==i.RENDERED)return this.isHintsDisplayed=!0,this.itemPlayer.showHints()},t.prototype.hideHints=function(){this.ItemLifeCycleState==i.RENDERED&&(this.isHintsDisplayed=!1,this.itemPlayer.hideHints())},t.prototype.hasHints=function(){return this.ItemLifeCycleState>=i.LOADED&&this.itemPlayer.hasHints()},t.prototype.remainingHints=function(){return this.ItemLifeCycleState>=i.LOADED?this.itemPlayer.remainingHints():0},t.prototype.destroy=function(){try{this.ItemLifeCycleState>=i.LOADED&&(this.ItemLifeCycleState=i.LOADED,this.itemPlayer.destroy())}catch(t){this.errorHandler(this.launchId,t)}},t.prototype.focalise=function(){try{this.ItemLifeCycleState==i.RENDERED&&this.itemPlayer.focalise()}catch(t){this.errorHandler(this.launchId,t)}},t.prototype.hide=function(){this.ItemLifeCycleState==i.RENDERED&&this.itemPlayer.hide()},t.prototype.show=function(){this.ItemLifeCycleState==i.RENDERED&&this.itemPlayer.show()},t.prototype.getState=function(){return this.ItemLifeCycleState==i.RENDERED?this.itemPlayer.getState():this.state},t.prototype.setState=function(t,e){(t||e==a.LaunchModes.REVIEW)&&(this.ItemLifeCycleState==i.RENDERED?this.itemPlayer.setState(t,e):(this.state=t,this.launchMode=e))},t.prototype.getOptimumDimensions=function(){return this.ItemLifeCycleState==i.RENDERED?this.itemPlayer.getOptimumDimensions():{height:0,width:0}},t.prototype.canShowAnswer=function(){return this.ItemLifeCycleState>=i.LOADED&&this.itemPlayer.canShowAnswer()},t.prototype.getScore=function(){var t=null;return this.ItemLifeCycleState>=i.LOADED&&(t=this.itemPlayer.getScore()),t},t.prototype.hasUserResponse=function(){return this.ItemLifeCycleState>=i.LOADED&&this.itemPlayer.hasUserResponse()},t.prototype.hideAnswer=function(){this.ItemLifeCycleState==i.RENDERED&&this.itemPlayer.hideAnswer()},t.prototype.showAnswer=function(){this.ItemLifeCycleState==i.RENDERED&&this.itemPlayer.showAnswer()},t.prototype.displayFeedback=function(t){this.ItemLifeCycleState==i.RENDERED&&this.itemPlayer.displayFeedback(t.score)},t.prototype.isItemJsonValid=function(){return!(!this.itemJSON||"item"!=this.itemJSON.type||!this.itemJSON.model)},t.prototype.fetchItemJSON=function(t){var e=this;return new Promise((function(n,i){if("object"==typeof t)n(t);else if(s.isURL(t))fetch(t).then((function(t){return t.json()})).then((function(t){return n(t)})).catch((function(t){e.errorHandler(r.EVENTS.ERROR,t),i(t)}));else if("string"==typeof t){LeonardoApp.Services.get("items").getItem(t).then((function(t){if(t.message)throw new Error(t.message);n(t)})).catch((function(t){e.errorHandler(r.EVENTS.ERROR,t),i(t)}))}}))},t.prototype.loadItemPlayer=function(t){var e=this,n=LeonardoApp.PlayerLoader;return new Promise((function(i,o){n?n.loadPlayer(t,a.RendererTypes.PLAYER).then((function(t){return i(t)})).catch((function(t){e.errorHandler(r.EVENTS.ERROR,t),o()})):(e.errorHandler(r.EVENTS.ERROR,"Module Loader not available"),o())}))},t.prototype.errorHandler=function(t,e){var n={launchId:t,type:r.EVENTS.ERROR,exception:e};this.eventMgr.emit(r.EVENTS.ERROR,new o.ErrorEventArgs(n))},t.prototype.renderItemPlayer=function(t,e){this.itemPlayer.initItem(this.uid,this.itemJSON,t,e),this.ItemLifeCycleState=i.RENDERED,this.launchMode!=a.LaunchModes.REVIEW&&null==this.state||this.setState(this.state,this.launchMode)},t.prototype.subscribe=function(t,e){},t.prototype.unsubscribe=function(t,e){},t}();e.ItemApp=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isURL=function(t){return new RegExp("(?:(?:https?|ftp|file)://|www.|ftp.)(?:([-A-Z0-9+&@#/%=~_|$?!:,.]*)|[-A-Z0-9+&@#/%=~_|$?!:,.])*(?:([-A-Z0-9+&@#/%=~_|$?!:,.]*)|[A-Z0-9+&@#/%=~_|$])","i").test(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=function(){function t(t){for(var e in this.type=t.type,this.subType=t.subType,this.itemId=t.itemId,this.itemMeta=new r(t.itemMeta),this.itemFragments={},t.itemFragments)this.itemFragments[e]=new s(t.itemFragments[e])}return t.prototype.setActivityState=function(t){if(t.itemId!=this.itemId)throw new Error("The given state doesn't belong to this activity. Please pass correct state.");if(this.itemMeta.getStatus()!=i.Status.COMPLETED&&(t.itemMeta&&(t.itemMeta.status&&this.itemMeta.setStatus(t.itemMeta.status),t.itemMeta.selectedItemIndex&&this.itemMeta.setSelectedItemIndex(t.itemMeta.selectedItemIndex)),t.itemFragments))for(var e in t.itemFragments)this.itemFragments[e]&&this.itemFragments[e].setState(t.itemFragments[e])},t.prototype.getActivityState=function(){return this},t.prototype.setSelectedItemIndex=function(t){this.itemMeta.setSelectedItemIndex(t)},t.prototype.getSelectedItemIndex=function(){return this.itemMeta.getSelectedItemIndex()},t.prototype.setActivityScore=function(t){this.itemMeta.setScore(t),this.itemMeta.setStatus(i.Status.COMPLETED)},t.prototype.getActivityScore=function(){return this.itemMeta.getScore()},t.prototype.getActivityStatus=function(){return this.itemMeta.getStatus()},t.prototype.setItemScore=function(t,e){this.checkItemUpdationStatus(t)&&this.itemFragments[t].setItemScore(e)},t.prototype.getItemScore=function(t){return this.itemFragments[t].getItemScore()},t.prototype.setItemStatus=function(t,e){this.getActivityStatus()!=i.Status.COMPLETED&&this.itemFragments[t]&&this.itemFragments[t].setItemStatus(e)},t.prototype.getItemStatus=function(t){return this.itemFragments[t].getItemStatus()},t.prototype.setItemState=function(t,e){this.checkItemUpdationStatus(t)&&(this.itemFragments[t].setItemState(e),this.itemFragments[t].setItemStatus(i.Status.INPROGRESS))},t.prototype.getItemState=function(t){return this.itemFragments[t].getItemState()},t.prototype.checkItemUpdationStatus=function(t){return this.getActivityStatus()!=i.Status.COMPLETED&&null!=this.itemFragments[t]&&this.itemFragments[t].getItemStatus()!=i.Status.COMPLETED},t}();e.ActivityStateService=o;var r=function(){function t(t){this.score=t.score,this.selectedItemIndex=t.selectedItemIndex||0,this.status=t.status||i.Status.INPROGRESS}return t.prototype.setState=function(t){t.score&&(this.score=t.score),t.selectedItemIndex&&(this.selectedItemIndex=t.selectedItemIndex),t.status&&(this.status=t.status)},t.prototype.setScore=function(t){this.score=t},t.prototype.getScore=function(){return this.score},t.prototype.setSelectedItemIndex=function(t){this.selectedItemIndex=t},t.prototype.getSelectedItemIndex=function(){return this.selectedItemIndex},t.prototype.setStatus=function(t){this.status=t},t.prototype.getStatus=function(){return this.status},t}(),s=function(){function t(t){this.state=t.state,this.status=t.status||i.Status.NOTSTARTED,this.score=t.score}return t.prototype.setState=function(t){t.state&&(this.state=t.state),t.status&&(this.status=t.status),t.score&&(this.score=t.score)},t.prototype.setItemState=function(t){this.state=t},t.prototype.getItemState=function(){return this.state},t.prototype.setItemStatus=function(t){this.status=t},t.prototype.getItemStatus=function(){return this.status},t.prototype.setItemScore=function(t){this.score=t},t.prototype.getItemScore=function(){return this.score},t}()},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),s=n(1),a=n(15),c=n(18);n(19),n(20);var u=n(4),p=n(3),l=n(5),h=n(6),d=n(7),m=n(21),f=function(t){function e(e){var n=t.call(this,e)||this;return n.isRenderingComplete=!1,n.itemButtonState={},n.miapVersion="0.0.30",n}return o(e,t),e.prototype.render=function(t){this.props.registerChildComp(s.Components.ACTIVITY_PLAYER,this);var e,n,i=t.context.options&&t.context.options.playerConfig;i&&(this.playerUiStyles=e=i.uiStyles,n=i.buttons);var o=this.props.selectedItemIndex,u=!n||null==n.visible||n.visible,p="activity-player-container",l="item-loader";u||(p+=" without-button-bar"),e&&e.dimensions&&"content-space"==e.dimensions?p+=" ap-content-dim":l+=" expanded-loader";var h={registerChildComp:this.registerChildComp.bind(this),renderItem:this.props.context.renderItem.bind(this.props.context),itemRenderingComplete:this.onItemRendered.bind(this),itemNavigated:this.triggerNavigationEvent.bind(this),renderedItemDisplayed:this.renderedItemDisplayed.bind(this)},d={registerChildComp:this.registerChildComp.bind(this),buttonClick:this.onButtonClick.bind(this)},f={registerChildComp:this.registerChildComp.bind(this)};return r.h("div",{"miap-version":this.miapVersion,class:p,style:this.getUiStyles(e)},r.h(m.LoaderComponent,{callback:f,loaderClass:l}),r.h(c.ItemContainerComponent,{isButtonBarVisible:u,selectedItemIndex:o,callback:h,uiStyles:e}),u&&r.h(a.ButtonBarComponent,{callback:d}))},e.prototype.registerChildComp=function(t,e){switch(t){case s.Components.BUTTON_BAR:this.buttonBarComp=e;break;case s.Components.ITEM_PLAYER:this.itemContainerComp=e;break;case s.Components.LOADER:this.loaderComp=e}},e.prototype.onItemRendered=function(t){if(this.props.context.setCurrentItem(t._currentItem),this.buttonBarComp){var e=this.props.context.getCurrentItemIndex(),n=null;this.itemButtonState[e]&&(n=this.itemButtonState[e].buttonState),this.buttonBarComp.updateView(n||this.defaultButtonBarConfig())}},e.prototype.getOptimumDimensions=function(t){var e=getComputedStyle(this.base),n={height:0,width:0};if(this.itemContainerComp){var i=this.itemContainerComp.getOptimumDimensions(t);n.height=i.height,n.width=i.width}else console.log("Item Player is not rendered yet.");if(this.buttonBarComp){var o=this.buttonBarComp.getOptimumDimensions();n.height+=o.height,n.width=Math.max(n.width,o.width)}var r=parseFloat(e.marginTop)+parseFloat(e.marginBottom)+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),s=parseFloat(e.marginLeft)+parseFloat(e.marginRight)+parseFloat(e.borderLeftWidth)+parseFloat(e.borderRightWidth)+parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);return n.height+=r,n.width+=s,n},e.prototype.destroy=function(){this.itemContainerComp.destroy(),this.itemContainerComp=null,this.buttonBarComp=null,this.isRenderingComplete=null,this.itemButtonState=null;r.render(r.h((function(){return null}),null),document.body,this.base),this.nextBase=null},e.prototype.onItemNavigation=function(t,e){var n=this.props.context.getCurrentItem(),i=this.props.context.getCurrentItemIndex(),o=this.getNavigationBtnsConfig(),r=[];o.state==s.NAVIGATION_BUTTONS_STATE.DISABLED&&(r=o.buttons);var a=!1;if(n.isHintsDisplayed&&-1==n.remainingHints()&&(n.hideHints(),a=!0),this.buttonBarComp){var c=d.cloneObject(this.buttonBarComp.getButtonConfig());a&&(c.hiddenButtons=c.hiddenButtons.concat(l.ButtonBarIcons.closeHint)),c.disabledButtons=c.disabledButtons.concat(r),this.itemButtonState[i]={buttonState:c}}this.updateActItemState(),this.moveToItem(t,e)},e.prototype.reset=function(){this.buttonBarComp&&this.buttonBarComp.updateView(this.defaultButtonBarConfig())},e.prototype.onButtonClick=function(t){var e=t.currentTarget.getAttribute("id"),n=l.ButtonBarIcons[e],i=[],o=[],r=this.getNavigationBtnsConfig();r.state==s.NAVIGATION_BUTTONS_STATE.HIDDEN?o=r.buttons:i=r.buttons;var a=this.props.context.getCurrentItem();switch(n){case l.ButtonBarIcons.checkMyWork:var c=a.submit();i.push(l.ButtonBarIcons.reset,l.ButtonBarIcons.showHint),o.push(l.ButtonBarIcons.checkMyWork,l.ButtonBarIcons.closeHint),this.buttonBarComp.updateView({disabledButtons:i,hiddenButtons:o}),this.updateActItemState();var h={launchId:this.props.context.launchId,type:u.EVENTS.CHECK_ANSWER,itemId:a.leonardoId,response:c};this.props.context.eventMgr.emit(u.EVENTS.CHECK_ANSWER,new p.SubmitEventArgs(h));break;case l.ButtonBarIcons.reset:a.reset(),this.buttonBarComp.updateView(this.defaultButtonBarConfig()),this.updateActItemState();break;case l.ButtonBarIcons.tryAgain:a.retry(),this.buttonBarComp.updateView(this.defaultButtonBarConfig()),this.updateActItemState();h={launchId:this.props.context.launchId,type:u.EVENTS.RETRY};this.props.context.eventMgr.emit(u.EVENTS.RETRY,new p.EventArgs(h));break;case l.ButtonBarIcons.showHint:var d=a.showHints();o.push(l.ButtonBarIcons.tryAgain);var m=this.getHintButtonsConfig(d);o=o.concat(m.hiddenHintBtns),i=i.concat(m.disabledHintBtns),this.buttonBarComp.updateView({hiddenButtons:o,disabledButtons:i}),this.updateActItemState();break;case l.ButtonBarIcons.closeHint:a.hideHints(),o.push(l.ButtonBarIcons.tryAgain,l.ButtonBarIcons.closeHint),this.buttonBarComp.updateView({hiddenButtons:o,disabledButtons:i}),this.updateActItemState();break;case l.ButtonBarIcons.previous:this.onItemNavigation(s.NAVIGATION_EVENTS.PREVIOUS);break;case l.ButtonBarIcons.next:this.onItemNavigation(s.NAVIGATION_EVENTS.NEXT)}},e.prototype.triggerNavigationEvent=function(t,e){var n=this.props.context.getItems(),i={launchId:this.props.context.launchId,previousItem:{id:t.uid,index:n.indexOf(t)},currentItem:{id:e.uid,index:n.indexOf(e)},type:u.EVENTS.ITEM_NAVIGATION};this.props.context.eventMgr.emit(u.EVENTS.ITEM_NAVIGATION,new p.NavigationEventArgs(i))},e.prototype.resizeActivityPlayer=function(t){this.playerUiStyles&&this.playerUiStyles.dimensions&&"container-space"==this.playerUiStyles.dimensions||t&&(this.base.style.height=t.height+"px")},e.prototype.renderedItemDisplayed=function(t){this.props.context.onSizeHandler({size:t})},e.prototype.onLaunchedHandler=function(){this.loaderComp.visibilityHandler(!1),this.buttonBarComp&&this.buttonBarComp.visibilityHandler(!0),this.onItemLaunch()},e.prototype.updateActItemState=function(){this.props.context.updateCurrentItemState()},e.prototype.moveToItem=function(t,e){var n=this.props.context.getCurrentItemIndex();switch(t){case s.NAVIGATION_EVENTS.PREVIOUS:this.props.context.getItem(n-1)?this.itemContainerComp.setState({selectedItemIndex:n-1}):console.log("Already on First Item");break;case s.NAVIGATION_EVENTS.NEXT:this.props.context.getItem(n+1)?this.itemContainerComp.setState({selectedItemIndex:n+1}):console.log("Already on Last Item");break;case s.NAVIGATION_EVENTS.SPECIFIC:this.props.context.getItem(e)?this.itemContainerComp.setState({selectedItemIndex:e}):console.log("Item doesnot exist. Please provide correct item index")}},e.prototype.getUiStyles=function(t){var e="";if(t){var n=["border","box-shadow"];for(var i in t)n.indexOf(i)>=0&&(e+=i+":"+t[i]+";")}return e},e.prototype.defaultButtonBarConfig=function(){var t=h.checkMyWorkBtn.concat(h.resetBtn,h.navigationBtn),e=[],n=[l.ButtonBarIcons.tryAgain],i=this.getNavigationBtnsConfig();i.state==s.NAVIGATION_BUTTONS_STATE.HIDDEN?n=n.concat(i.buttons):e=i.buttons;var o=this.getHintButtonsConfig();return t=t.concat(o.availableHintBtns),n=n.concat(o.hiddenHintBtns),{allButtons:t,disabledButtons:e=e.concat(o.disabledHintBtns),hiddenButtons:n}},e.prototype.getNavigationBtnsConfig=function(){var t,e=[];if(1==this.props.context.getItemCount())t=s.NAVIGATION_BUTTONS_STATE.HIDDEN,e.push(l.ButtonBarIcons.previous,l.ButtonBarIcons.next);else{t=s.NAVIGATION_BUTTONS_STATE.DISABLED;var n=this.props.context.getCurrentItemIndex();0==n?e.push(l.ButtonBarIcons.previous):n==this.props.context.getItemCount()-1&&e.push(l.ButtonBarIcons.next)}return{state:t,buttons:e}},e.prototype.getHintButtonsConfig=function(t){var e=this.props.context.getCurrentItem(),n=[],i=[],o=[];return e.hasHints()&&(n=n.concat(h.hintsBtn),-1==(t=null!=t?t:e.remainingHints())?e.isHintsDisplayed?(o.push(l.ButtonBarIcons.showHint),i=[]):(o.push(l.ButtonBarIcons.closeHint),i=[]):0==t?(o.push(l.ButtonBarIcons.closeHint),i=[l.ButtonBarIcons.showHint]):t>0&&(o.push(l.ButtonBarIcons.closeHint),i=[])),{availableHintBtns:n,hiddenHintBtns:o,disabledHintBtns:i}},e.prototype.onItemLaunch=function(){if(!this.isRenderingComplete){this.isRenderingComplete=!0;var t={launchId:this.props.context.launchId,type:u.EVENTS.LAUNCHED};this.props.context.eventMgr.emit(u.EVENTS.LAUNCHED,new p.EventArgs(t)),this.base.classList.contains("ap-content-dim")&&(this.base.style.display="inline-block")}},e}(r.Component);e.MultiItemActivityComponent=f},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),s=n(1),a=n(6),c=n(5),u=n(16),p=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isVisible:!0,allButtons:a.checkMyWorkBtn.concat(a.resetBtn,a.navigationBtn),hiddenButtons:[c.ButtonBarIcons.tryAgain,c.ButtonBarIcons.next,c.ButtonBarIcons.previous,c.ButtonBarIcons.checkMyWork,c.ButtonBarIcons.reset],disabledButtons:[]},n}return o(e,t),e.prototype.componentDidMount=function(){this.props.callback.registerChildComp(s.Components.BUTTON_BAR,this)},e.prototype.render=function(t){if(this.state.isVisible)return r.h("div",{class:"buttons-container"},this.createButtons())},e.prototype.updateView=function(t){this.setState(t)},e.prototype.getOptimumDimensions=function(){var t={height:0,width:0},e=this.base.cloneNode(!0);e.style.display="inline-block",e.style.visibility="hidden",e.style.position="absolute",document.body.appendChild(e);var n=getComputedStyle(e);return t.height=parseFloat(n.height)+parseFloat(n.marginTop)+parseFloat(n.marginBottom),t.width=parseFloat(n.width)+parseFloat(n.marginLeft)+parseFloat(n.marginRight),document.body.removeChild(e),t},e.prototype.getButtonConfig=function(){return this.state},e.prototype.createButtons=function(){var t=this,e=[],n=this.state.hiddenButtons.length>0?this.getVisibleButtons():this.state.allButtons;return n.map((function(i,o){e.push(t.createButtonJSX(i),o<n.length-1?r.h("div",{class:"vertical-seperator"}):null)})),e},e.prototype.createButtonJSX=function(t){var e=this.state.disabledButtons.indexOf(t.id)>-1;return r.h(u.ButtonComponent,{id:t.id,className:t.className?t.className:null,leftIcon:t.icon?t.icon.iconCls_left:null,rightIcon:t.icon?t.icon.iconCls_right:null,label:t.text,tooltip:t.tooltip,isDisabled:e,onButtonClick:this.props.callback.buttonClick})},e.prototype.getVisibleButtons=function(){var t=this;return this.state.allButtons.filter((function(e){return-1==t.state.hiddenButtons.indexOf(e.id)}))},e.prototype.visibilityHandler=function(t){this.state.isVisible!=t&&this.setState({isVisible:t})},e}(r.Component);e.ButtonBarComponent=p},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);n(17);var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.render=function(t,e){return r.h("button",{className:t.className,title:t.tooltip,id:t.id,disabled:t.isDisabled,onClick:function(e){return t.onButtonClick(e)}},t.leftIcon&&r.h("span",{class:t.leftIcon}),r.h("span",{class:"btn-text"}," ",t.label," "),t.rightIcon&&r.h("span",{class:t.rightIcon}))},e}(r.Component);e.ButtonComponent=s},function(t,e,n){},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),s=n(1),a=n(7),c=function(t){function e(e){var n=t.call(this,e)||this;return n.renderedItems=[],n.activityUIStyles=null,n.state={selectedItemIndex:n.props.selectedItemIndex},n}return o(e,t),e.prototype.componentDidMount=function(){this.renderSelectedItemPlayer()},e.prototype.render=function(t,e){this.props.callback.registerChildComp(s.Components.ITEM_PLAYER,this);var n="item-player-container",i=t.uiStyles;return this.activityUIStyles=i&&a.cloneObject(i),t.isButtonBarVisible&&(n+=" default-button-bar"),i&&i.dimensions&&"content-space"==i.dimensions&&(n+=" ip-content-dim"),this.base&&this.updateItemContainer(),r.h("div",{class:n})},e.prototype.getOptimumDimensions=function(t){var e=t||this._currentItem.getOptimumDimensions(),n=getComputedStyle(this.base),i=parseFloat(n.marginTop)+parseFloat(n.marginBottom)+parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth)+parseFloat(n.paddingTop)+parseFloat(n.paddingBottom),o=parseFloat(n.marginLeft)+parseFloat(n.marginRight)+parseFloat(n.borderLeftWidth)+parseFloat(n.borderRightWidth)+parseFloat(n.paddingLeft)+parseFloat(n.paddingRight);return e.height+=i,e.width+=o,e},e.prototype.destroy=function(){this.base=null,this.activityUIStyles=null,this._currentItem=null,this.renderedItems=null},e.prototype.renderSelectedItemPlayer=function(){var t=this,e=this.createItemContainer(this.state.selectedItemIndex);this.props.callback.renderItem(this.state.selectedItemIndex,e).then((function(e){var n=t._currentItem;t._currentItem=e,t.renderedItems[t.state.selectedItemIndex]={id:e.index,itemInstance:e},t.activityUIStyles&&t.activityUIStyles.dimensions&&"content-space"==t.activityUIStyles.dimensions&&(t.base.style.display="inline-block",t.base.style.verticalAlign="top"),t.props.callback.itemRenderingComplete(t),n&&t.props.callback.itemNavigated(n,t._currentItem)}))},e.prototype.updateItemContainer=function(){this.hideItemContainer(this._currentItem);var t=this.state.selectedItemIndex,e=this.renderedItems[t];if(e&&e.itemInstance){var n=this._currentItem;this._currentItem=e.itemInstance,this.showItemContainer(this._currentItem),this.props.callback.itemRenderingComplete(this),this.props.callback.itemNavigated(n,this._currentItem)}else this.renderSelectedItemPlayer()},e.prototype.hideItemContainer=function(t){t.hideAnswer(),t.hide(),this.base.querySelector('div[index="'+t.index+'"]').style.display="none"},e.prototype.showItemContainer=function(t){this.base.querySelector('div[index="'+t.index+'"]').style.display="block",t.show(),this.props.callback.renderedItemDisplayed(t.getOptimumDimensions())},e.prototype.createItemContainer=function(t){var e=document.createElement("div");return e.style.height="100%",e.setAttribute("index",t),this.base.appendChild(e),e},e}(r.Component);e.ItemContainerComponent=c},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),s=n(1),a=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isVisible:!0},n}return o(e,t),e.prototype.componentDidMount=function(){this.props.callback.registerChildComp(s.Components.LOADER,this)},e.prototype.render=function(){if(this.state.isVisible)return r.h("div",{class:this.props.loaderClass})},e.prototype.visibilityHandler=function(t){t!=this.state.isVisible&&this.setState({isVisible:t})},e}(r.Component);e.LoaderComponent=a}]).default}));
//# sourceMappingURL=multiItemActivityPlayer.js.map